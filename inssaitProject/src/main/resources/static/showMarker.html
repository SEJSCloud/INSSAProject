<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>여러개 마커 표시하기</title>

</head>

<body>
    <button onclick="insertMarkers()">그리기</button>
    <div id="map" style="width:100%;height:350px;"></div>

    <script type="text/javascript"
        src="//dapi.kakao.com/v2/maps/sdk.js?appkey=00f87dfc64daeb277224676ae0cf3f88"></script>
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
    <script>
        var array = [];
        function insertMarkers() {
            axios.get("http://127.0.0.1:8000/getLocationInfo")
                .then(resData => {
                    for (let i = 0; i < resData.data.length; i++) {
                        if (Object.keys(resData.data[i].sourceAsMap).includes("place_url")) {
                            array.push(resData.data[i].sourceAsMap);
                        }
                    }
                    console.log(array);
                    var mapContainer = document.getElementById('map'), // 지도를 표시할 div  
                        mapOption = {
                            center: new kakao.maps.LatLng(37.5670399093241, 126.875607758973), // 지도의 중심좌표
                            level: 14 // 지도의 확대 레벨
                        };

                    var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다

                    // 마커를 표시할 위치와 title 객체 배열입니다 
                    var positions = [
                        {
                            title: '카카오',
                            latlng: new kakao.maps.LatLng(33.450705, 126.570677)
                        },
                        {
                            title: '생태연못',
                            latlng: new kakao.maps.LatLng(33.450936, 126.569477)
                        },
                        {
                            title: '텃밭',
                            latlng: new kakao.maps.LatLng(33.450879, 126.569940)
                        },
                        {
                            title: '근린공원',
                            latlng: new kakao.maps.LatLng(33.451393, 126.570738)
                        }
                    ];

                    // 마커 이미지의 이미지 주소입니다
                    var imageSrc = "http://t1.daumcdn.net/localimg/localimages/07/mapapidoc/markerStar.png";

                    for (var i = 0; i < array.length; i++) {

                        // 마커 이미지의 이미지 크기 입니다
                        var imageSize = new kakao.maps.Size(24, 35);

                        // 마커 이미지를 생성합니다    
                        var markerImage = new kakao.maps.MarkerImage(imageSrc, imageSize);

                        // 마커를 생성합니다
                        var marker = new kakao.maps.Marker({
                            map: map, // 마커를 표시할 지도
                            position: new kakao.maps.LatLng(array[i].y, array[i].x), // 마커를 표시할 위치
                            title: array[i].place_name, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
                            image: markerImage // 마커 이미지 
                        });
                    }
                })
                .catch(error => {
                    console.log("비정상 응답 ", error);
                });
        }


    </script>
</body>

</html>